<%- include("partials/header") %>

<div class="container my-5" style="max-width: 720px;">
  <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-center gap-2 mb-4">
    <div>
      <h1 class="mb-1">Upraviť profil</h1>
      <p class="text-muted mb-0">Uprav si meno, používateľské meno alebo zmeň heslo.</p>
    </div>
    <a class="btn btn-outline-secondary" href="/profil"><i class="fa-solid fa-arrow-left me-1"></i> Späť</a>
  </div>

  <% if (errors && errors.length > 0) { %>
    <div class="alert alert-danger alert-dismissible fade show" role="alert">
      <strong>Chyby:</strong>
      <ul class="mb-0 mt-2">
        <% errors.forEach(e => { %>
          <li><%= e %></li>
        <% }) %>
      </ul>
      <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
  <% } %>

  <div class="card shadow-sm">
    <div class="card-body">
      <form action="/profil/edit" method="POST" class="js-validate" novalidate>
        <input type="hidden" name="_csrf" value="<%= csrfToken %>">

        <div class="row g-3">
          <div class="col-md-6">
            <label for="first_name" class="form-label">Meno</label>
            <input
              id="first_name"
              name="first_name"
              type="text"
              class="form-control"
              value="<%= formData.first_name || "" %>"
              minlength="2"
              maxlength="100"
              required
            />
            <div class="invalid-feedback">Zadaj meno (min. 2 znaky).</div>
          </div>

          <div class="col-md-6">
            <label for="last_name" class="form-label">Priezvisko</label>
            <input
              id="last_name"
              name="last_name"
              type="text"
              class="form-control"
              value="<%= formData.last_name || "" %>"
              minlength="2"
              maxlength="100"
              required
            />
            <div class="invalid-feedback">Zadaj priezvisko (min. 2 znaky).</div>
          </div>
        </div>

        <div class="mt-3">
          <label for="username" class="form-label">Používateľské meno</label>
          <input
            id="username"
            name="username"
            type="text"
            class="form-control"
            value="<%= formData.username || "" %>"
            minlength="2"
            maxlength="100"
            required
          />
          <div class="invalid-feedback">Zadaj používateľské meno (min. 2 znaky).</div>
        </div>

        <div class="mt-3">
          <label for="email" class="form-label">E-mail (nemenný)</label>
          <input
            id="email"
            type="email"
            class="form-control"
            value="<%= formData.email || "" %>"
            disabled
          />
        </div>

        <hr class="my-4" />

        <h5 class="mb-2">Zmena hesla (voliteľné)</h5>
        <p class="text-muted" style="font-size: 0.95rem;">
          Ak nechceš meniť heslo, nechaj tieto polia prázdne.
        </p>

        <div class="row g-3">
          <div class="col-md-6">
            <label for="password" class="form-label">Nové heslo</label>
            <input
              id="password"
              name="password"
              type="password"
              class="form-control"
              minlength="8"
              maxlength="100"
              autocomplete="new-password"
            />
            <div class="form-text">Minimzka 8 znakov.</div>
          </div>
          <div class="col-md-6">
            <label for="password_confirm" class="form-label">Potvrdiť heslo</label>
            <input
              id="password_confirm"
              name="password_confirm"
              type="password"
              class="form-control"
              minlength="8"
              maxlength="100"
              autocomplete="new-password"
            />
          </div>
        </div>

        <div class="d-grid gap-2 d-sm-flex justify-content-sm-start mt-4">
          <button type="submit" class="btn btn-primary">
            <i class="fa-solid fa-floppy-disk me-1"></i> Uložiť zmeny
          </button>
          <a href="/profil" class="btn btn-outline-secondary">Zrušiť</a>
        </div>
      </form>
    </div>
  </div>
</div>

<%- include("partials/footer") %>
